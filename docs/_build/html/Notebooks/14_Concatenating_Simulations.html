<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Concatenated simulations &mdash; MobsPy 2.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=f35be339"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API" href="../api.html" />
    <link rel="prev" title="Events" href="13_Events.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            MobsPy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="01_Basic_Intro.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_Basic_Intro.html#Meta-Reaction-Syntax">Meta-Reaction Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_Basic_Intro.html#How-MobsPy-works?">How MobsPy works?</a></li>
<li class="toctree-l1"><a class="reference internal" href="01_Basic_Intro.html#Following-Notebooks">Following Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_Reaction_Inheritance.html">Reaction Inheritance</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_Characteristics.html">Characteristics</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_Characteristic_restriction.html">Restraints</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_For_Loops.html">For Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_Order_Matters.html">Order of Reactants and Products</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_Initial_Condition.html">Count/Concentration Assignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_Initial_Condition.html#Set-count-function">Set count function</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_Units.html">Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_Result_Data.html">Simulation Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_Reaction_Rates.html">Reaction Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_Looping_Through_Species.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_Looping_Through_Species.html#Characteristics">Characteristics</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_Looping_Through_Species.html#List-Species">List Species</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_Born_Species.html">Born Species</a></li>
<li class="toctree-l1"><a class="reference internal" href="13_Events.html">Events</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Concatenated simulations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MobsPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Concatenated simulations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Notebooks/14_Concatenating_Simulations.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Concatenated-simulations">
<h1>Concatenated simulations<a class="headerlink" href="#Concatenated-simulations" title="Link to this heading">ÔÉÅ</a></h1>
<p>MobsPy allows for combining simulations. In combined simulations, the results from the precedent simulations is fed to the following ones. Thus, allowing the user to make changes to the models for subsequent simulations.</p>
<p>Here we suply an example where in the first simulation species A grows according to a rate. Afterwards, A stops growing and it must compete with a species B.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mobspy</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">BaseSpecies</span><span class="p">()</span>

<span class="n">A</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="o">*</span><span class="n">A</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">S1</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">S1</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">A</span><span class="o">.</span><span class="n">reset_reactions</span><span class="p">()</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">BaseSpecies</span><span class="p">()</span>

<span class="n">A</span> <span class="o">+</span> <span class="n">B</span> <span class="o">&gt;&gt;</span> <span class="n">Zero</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">]</span>

<span class="n">B</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">S2</span> <span class="o">=</span> <span class="n">Simulation</span> <span class="p">(</span><span class="n">A</span> <span class="o">|</span> <span class="n">B</span><span class="p">)</span>
<span class="n">S2</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">B</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">S</span> <span class="o">=</span> <span class="n">S1</span> <span class="o">+</span> <span class="n">S2</span>
<span class="n">S</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;stochastic&#39;</span>
<span class="n">S</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Compiling model
Compiling model
Starting Simulator
Running simulation in parallel
Simulation is Over
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Notebooks_14_Concatenating_Simulations_1_1.png" src="../_images/Notebooks_14_Concatenating_Simulations_1_1.png" />
</div>
</div>
<p>An important point to note is that species counts must always be defined before the creation of the simulation object. For the subsequent simulations, if a count was defined before the simulation object creation, it will override the resulting value from the previous sim.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BaseSpecies</span><span class="p">()</span>

<span class="n">A</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="o">*</span><span class="n">A</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">B</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="o">*</span><span class="n">B</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">S1</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span><span class="n">A</span> <span class="o">|</span> <span class="n">B</span><span class="p">)</span>
<span class="n">S1</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">4</span>

<span class="c1"># This overrides the value of B from S1</span>
<span class="n">B</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">S2</span> <span class="o">=</span> <span class="n">Simulation</span> <span class="p">(</span><span class="n">A</span> <span class="o">|</span> <span class="n">B</span><span class="p">)</span>
<span class="n">S2</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">S</span> <span class="o">=</span> <span class="n">S1</span> <span class="o">+</span> <span class="n">S2</span>
<span class="n">S</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;stochastic&#39;</span>
<span class="n">S</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Compiling model
Compiling model
Starting Simulator
Running simulation in parallel
Simulation is Over
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Notebooks_14_Concatenating_Simulations_3_1.png" src="../_images/Notebooks_14_Concatenating_Simulations_3_1.png" />
</div>
</div>
<p>For events in concatenated simulations, the event time is based-around each simulation individually and not the global time. Each new simulation starts counting from zero again when considering the event trigger time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">BaseSpecies</span><span class="p">()</span>

<span class="n">A</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="o">*</span><span class="n">A</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">B</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="o">*</span><span class="n">B</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">S1</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span><span class="n">A</span> <span class="o">|</span> <span class="n">B</span><span class="p">)</span>
<span class="n">S1</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">4</span>

<span class="c1"># This overrides the value of B from S1</span>
<span class="n">B</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">S2</span> <span class="o">=</span> <span class="n">Simulation</span> <span class="p">(</span><span class="n">A</span> <span class="o">|</span> <span class="n">B</span><span class="p">)</span>
<span class="n">S2</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># The event will trigger at time 5 when S2 time is equal to 1</span>
<span class="k">with</span> <span class="n">S2</span><span class="o">.</span><span class="n">event_time</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">A</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># The event will not trigger as the duration of S2 is equal to 2</span>
<span class="k">with</span> <span class="n">S2</span><span class="o">.</span><span class="n">event_time</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">A</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="n">S</span> <span class="o">=</span> <span class="n">S1</span> <span class="o">+</span> <span class="n">S2</span>
<span class="n">S</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;stochastic&#39;</span>
<span class="n">S</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Compiling model
Compiling model
Starting Simulator
Running simulation in parallel
Simulation is Over
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/Notebooks_14_Concatenating_Simulations_5_1.png" src="../_images/Notebooks_14_Concatenating_Simulations_5_1.png" />
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="13_Events.html" class="btn btn-neutral float-left" title="Events" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../api.html" class="btn btn-neutral float-right" title="API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, R√©mi Baron, Fabricio Cravo, Matthias Fuegger, Thomas Nowak.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>